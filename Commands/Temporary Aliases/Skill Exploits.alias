<drac2>
c = character()
com = combat()
a = argparse(&ARGS&)
fail = 'fail' in &ARGS&
adv = 'adv' in &ARGS&
dis = 'dis' in &ARGS&
tadv = 'tadv' in &ARGS&
tdis = 'tdis' in &ARGS&
target = a.last('t')
combatant = com.get_combatant(target)
cc="Battle Cry"
i = '-i' in &ARGS&
cc = "Battle Cry"
v = c.cc_exists(cc) or i

base = f'''embed -thumb {image} -color {color}'''

if not combatant:
    return err(f"Invalid target")

if v:
    for (n, s) in character().skills:
        if n.lower() == "intimidation":
            skill = s
            break

    if skill.adv or adv:
        roll_str = f"2d20kh1 + {skill.value}"
    elif dis:
        roll_str = f"2d20kl1 + {skill.value}"
    else:
        roll_str = f"1d20 + {skill.value}"

    check = vroll(roll_str)

    f_str = f"**Intimidation save DC:** {check}\n"

    base += f''' -f "Meta|{f_str}" '''

    save = combatant.save("wisdom", adv=True if tadv else False if tdis else None)

    if save.total < check.total or fail:
        f_str = f"{save}; *Failure!*\n**Effect:** - [Frightened] added"
        combatant.add_effect("Frightened", duration="1")
    else:
        f_str = f"{save}; **Success!**"

    base += f''' -f "{combatant.name}|{f_str}" '''

    base += f''' -title "{name} shouts their {cc}!" '''
    base += f''' -f "Effect|You attempt to demoralize one humanoid you can see within 30 feet of you that can see and hear you. Make a Charisma (Intimidation) check contested by the targetâ€™s Wisdom (Insight) check. If your check succeeds, the target is frightened until the end of your next turn." '''

if not c.cc_exists(cc):
    base += f''' -title "{name} has no custom counter {cc}!" '''
elif not c.get_cc(cc):
    base += f''' -title "{name} needs to take a rest to replenish their {cc}!" '''

if not i:
    c.mod_cc(cc, -1)
    base += f''' -f "{cc}|{c.cc_str(cc)} (-1)" '''

return base
</drac2>