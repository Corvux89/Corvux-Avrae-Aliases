def processAttacks(attacks, args):
    out = []
    c = character()
    for i, a in enumerate(attacks):
        attack = dump_json(a)
        counter = ""
        prop = getProperties(attack)

        if args.get('title'):
            attack = attack.replace(f'{processName(a.name)}', f'{args.last("title")}')

        if args.get('b'):
            attack=attack.replace('getAttackBonus": "', f'getAttackBonus": "{args.last("b")}+')

        if args.get('d'):
            attack=attack.replace('} [', '}' + f'+{args.last("d")} [')

        if args.get('criton'):
            attack=attack.replace('_v": 2', f'_v": 2,"criton":{args.last("criton")}')

        if args.get('c'):
            attack=attack.replace('_v": 2', f'_v": 2,"extra_crit_damage": "{args.last("c")}"')

        if args.get('noprof'):
            attack=attack.replace('proficiencyBonus+', '').replace('+proficiencyBonus', '')

        if args.get('offhand'):
            attack = updateName(attack, "Offhand")
            if "finesse" in prop:
                attack = attack.replace('+{max(strengthMod,dexterityMod)}', '')
            elif "heavy" in prop:
                attack = attack.replace('+{ceil(strengthMod*1.5)}', '')
            attack = attack.replace('+{dexterityMod}', '')
            attack = attack.replace('+{strengthMod}', '')

        if args.get('double'):
            attack = updateName(attack, "Double", False)
            if "finesse" in prop:
                attack = attack.replace('+max(strengthMod,dexterityMod)','')
            elif "heavy" in prop:
                attack = attack.replace('+{ceil(strengthMod*1.5)}','')
            attack = attack.replace('+dexterityMod', '')
            attack = attack.replace('+strengthMod', '')

        if args.get('gwm'):
            attack = updateName(attack, "Great", False)
            attack = attack.replace('proficiencyBonus+', '').replace('+proficiencyBonus', '')
            attack = attack.replace('} [', '}' + f'+{c.stats.prof_bonus*2} [')

        if args.get('sharp'):
            attack = updateName(attack, "Sharpshooter", False)
            attack = attack.replace('proficiencyBonus+', '').replace('+proficiencyBonus', '')
            attack = attack.replace('} [', '}' + f'+{c.stats.prof_bonus * 2} [')

        if args.get('enhanced'):
            attack = attack.replace('} [', '} [enhanced ')
            attack = attack.replace('[lightning]', '[enhanced lightning]')

        if args.get('gunning') and ("rapid - " in a.name.lower() or "burst - " in a.name.lower()):
            attack = attack.replace('"success": []',
                                    '"success": [{"type":"damage","damage":"{dexterityMod}","overheal":"false"}]')
            out.append(load_json(attack))
            attack = updateName(attack, "Gunning", False)
            attack = attack.replace('proficiencyBonus+', '').replace('+proficiencyBonus', '')
            attack = attack.replace('} [', '}' + f'+{c.stats.prof_bonus} [')

        if args.get('heavy'):
            if "finesse" in prop:
                attack = attack.replace('+{max(strengthMod,dexterityMod)}','+{ceil(strengthMod*1.5)}')
            attack = attack.replace('+{dexterityMod}', '+{ceil(strengthMod*1.5)}')
            attack = attack.replace('+{strengthMod}', '+{ceil(strengthMod*1.5)}')

        if args.get('dev'):
            attack = buildBurst(attack, args)


        if "counter" in attack:
            index = attack.find('"counter": "') + 12
            counter = str(attack[index:attack[index:].find('"')+index])
            if not c.cc_exists(counter):
                reload = int(prop[prop.index("reload "):].lstrip("reload ")[:2].rstrip(", "))
                c.create_cc(counter, 0, reload, None, 'bubble', reload)

        out.append(load_json(attack))

    return out, counter

def processName(name):
    out = name
    out = out.replace("Rapid - ", '').replace("Burst - ", '').replace("Two-Handed ", '').replace(" - Rifle", '').replace(" - Staff", '').replace("Penetrating - ",'')
    out = out.replace("Cartridge, Slug - ", '').replace("Cartridge, Corrosive - ", '').replace("Cartridge, Electrifying - ", '').replace("Cartridge, Gas - ", '')
    out = out.replace("Rocket, Fragmentation - ",'').replace("Rocket, Incendiary - ", '').replace("Rocket, Ion - ", '')
    out = out.replace("Missile, Fragmentation - ", '').replace("Missile, Incendiary - ", '').replace("Missile, Ion - ", '')
    out = out.replace("Arrow - ", '').replace("Arrow, Combustive - ", '').replace("Arrow, Electroshock - ", '').replace("Arrow, Noisemaker - ", '')
    out = out.replace("Dart - ", '').replace("Dart - Deafening - ", '').replace("Dart, Electrifying - ", '').replace("Dart, Panic - ", '')
    out = out.replace("Projector Canister, Corrosive - ", '').replace("Projector Canister, Cryo - ", '').replace("Projector Canister, Incendiary - ", '')
    out = out.replace("Acid - ", '').replace("Cold - ", '').replace("Fire - ", '').replace("Lightning - ", '')
    out = out.replace("Acid, ", '').replace("Cold, ", '').replace("Fire, ", '').replace("Lightning, ", '')
    out = out.replace("Bolt - ", '').replace("Bolt, Deafening - ", '').replace("Bolt, Electrifying - ", '').replace("Bolt, Panic - ", '')

    return out

def updateName(attack, prefix, cupdate=True):
    a = load_json(attack)
    test = attack
    test = test.replace(f'"name": "{a.name}"', f'"name": "{prefix} - {a.name}"')
    if cupdate and "counter" in test:
        index = test.find('"counter": "') + 12
        counter = str(test[index:test[index:].find('"') + index])
        test = test.replace(f'"counter": "{counter}"', f'"counter": "{prefix} {counter}"')
    return test

def getProperties(attack):
        a = load_json(attack)
        return str(a.automation[len(a.automation) - 2].get("text")).lower() if not a.automation[len(a.automation) - 1].get(
            "text") else str(a.automation[len(a.automation) - 1].get("text")).lower()


def buildBurst(attack, args):
    a = load_json(attack)
    dindex = attack.find('"damage": "') + 11
    damage_str = str(attack[dindex:attack[dindex:].find('"') + dindex])

    cindex = attack.find('"counter": "') + 12
    cName = str(attack[cindex:attack[cindex:].find('"') + cindex])

    automationRoll = {}
    automationRoll["type"] = "roll"
    automationRoll["dice"] = damage_str
    automationRoll["name"] = "damage"

    dmg = {}
    dmg["type"] = "damage"
    dmg["damage"] = "{damage}"
    dmg["overheal"] = False

    save = {}
    save["type"] = "save"
    save["stat"] = "dex"
    save["fail"] = []
    save["fail"].append(dmg)
    save["success"] = []
    save["dc"] = "8+proficiencyBonus+dexterityMod"

    counter = {}
    counter["type"] = "counter"
    counter["counter"] = cName
    counter["amount"] = "2" if args.last('dev') != '' else args.last('dev')
    counter["allowOverflow"] = False
    counter["errorBehavior"] = "raise"

    target = {}
    target["type"] = "target"
    target["target"] = "each"
    target["effects"] = []
    target["effects"].append(save)

    text = {}
    text["type"] = "text"
    text["text"] = f"{getProperties(attack)}, Burst {counter['amount']}"

    burstAttack = {}
    burstAttack["name"] = f"Burst - {a.name}"
    burstAttack["automation"] = []
    burstAttack["automation"].append(automationRoll)
    burstAttack["automation"].append(target)
    burstAttack["automation"].append(counter)
    burstAttack["automation"].append(text)
    burstAttack["_v"] = 2

    return dump_json(burstAttack)
